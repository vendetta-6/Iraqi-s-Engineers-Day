<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>جدار المهندسين العراقيين</title>
  <style>
    body {
      background: #808080;
      font-family: sans-serif;
      direction: rtl;
      text-align: center;
    }
    h2 {
      color: white;
      padding: 10px;
    }
    #wall {
      width: 100%;
      height: 100vh;
      position: relative;
      border: 5px solid #FFD700;
      background: #ADD8E6; /* Locked to light blue */
      overflow: hidden;
    }
    .note {
      position: absolute;
      padding: 15px;
      cursor: grab;
      transition: all 0.3s ease-in-out;
    }
    .note:hover {
      transform: scale(1.1) rotate(2deg);
    }
  </style>
</head>
<body>
  <h2>جدار المهندسين العراقيين</h2>

  <form id="noteForm">
    <input type="text" id="name" placeholder="اسمك" required />
    <input type="text" id="quote" placeholder="مقولتك" required />
    <input type="file" id="photoUpload" accept="image/*"/>
    <input type="color" id="bgColor" value="#FFD700"/> 
    <input type="color" id="textColor" value="#000000"/>
    <select id="shapeSelect">
      <option value="square">مربع</option>
      <option value="circle">دائرة</option>
      <option value="triangle">📐 مثلث</option>
      <option value="gear">⚙️ ترس</option>
      <option value="bolt">⚡ صاعقة</option>
      <option value="wrench">🔧 مفتاح</option>
    </select>
    <button type="submit">أضف قصاصتك</button>
  </form>

  <input type="text" id="searchBox" placeholder="ابحث عن مقولة..." />
  <button id="themeShuffle">تغيير المظهر</button>

  <div id="wall"></div>

  <script>
    const form = document.getElementById('noteForm');
    const wall = document.getElementById('wall');

    // Memory Saving System
    function saveStickers() {
      const stickers = [];
      document.querySelectorAll('.note').forEach(note => {
        stickers.push({
          name: note.getAttribute('data-name'),
          text: note.getAttribute('data-text'),
          color: note.style.backgroundColor,
          textColor: note.style.color,
          shape: note.getAttribute('data-shape'),
          left: note.style.left,
          top: note.style.top
        });
      });
      localStorage.setItem('stickers', JSON.stringify(stickers));
    }

    function loadStickers() {
      const stickers = JSON.parse(localStorage.getItem('stickers') || '[]');
      stickers.forEach(data => {
        addSticker(data.name, data.text, data.color, data.textColor, data.shape, data.left, data.top);
      });
    }

    function addSticker(name, quote, bgColor, textColor, shape, left = null, top = null) {
      const note = document.createElement('div');
      note.className = 'note';
      note.style.backgroundColor = bgColor;
      note.style.color = textColor;
      note.textContent = `${name}: ${quote}`;
      note.setAttribute('data-name', name);
      note.setAttribute('data-text', quote);
      note.setAttribute('data-shape', shape);

      switch (shape) {
        case 'circle': note.style.borderRadius = "50%"; break;
        case 'triangle': note.style.clipPath = "polygon(50% 0%, 0% 100%, 100% 100%)"; break;
        case 'gear': note.textContent += " ⚙️"; break;
        case 'bolt': note.textContent += " ⚡"; break;
        case 'wrench': note.textContent += " 🔧"; break;
      }

      if (left && top) {
        note.style.left = left;
        note.style.top = top;
      } else {
        note.style.left = Math.random() * 80 + '%';
        note.style.top = Math.random() * 80 + '%';
      }

      makeDraggable(note);
      wall.appendChild(note);
      saveStickers();
    }

    form.onsubmit = e => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const quote = document.getElementById('quote').value;
      const bgColor = document.getElementById('bgColor').value;
      const textColor = document.getElementById('textColor').value;
      const shape = document.getElementById('shapeSelect').value;

      addSticker(name, quote, bgColor, textColor, shape);
      form.reset();
    };

    function makeDraggable(el) {
      el.onmousedown = function(e) {
        e.preventDefault();
        const shiftX = e.clientX - el.getBoundingClientRect().left;
        const shiftY = e.clientY - el.getBoundingClientRect().top;

        function moveAt(pageX, pageY) {
          el.style.left = pageX - shiftX + 'px';
          el.style.top = pageY - shiftY + 'px';
        }

        function onMouseMove(e) {
          moveAt(e.pageX, e.pageY);
        }

        document.addEventListener('mousemove', onMouseMove);
        el.onmouseup = function() {
          document.removeEventListener('mousemove', onMouseMove);
          el.onmouseup = null;
          saveStickers();
        };
      };
    }

    loadStickers();
  </script>
</body>
</html>
